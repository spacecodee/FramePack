bucket_options = {
    640: [
        (416, 960),
        (448, 864),
        (480, 832),
        (512, 768),
        (544, 704),
        (576, 672),
        (608, 640),
        (640, 608),
        (672, 576),
        (704, 544),
        (768, 512),
        (832, 480),
        (864, 448),
        (960, 416),
    ],
    720: [
        (405, 720),
        (450, 800),
        (500, 888),
        (540, 960),
        (576, 1024),
        (640, 1138),
        (720, 1280),
        (800, 1138),
        (872, 1024),
        (960, 900),
        (1024, 768),
        (1138, 640),
        (1280, 720),
    ],
    1080: [
        (608, 1080),
        (675, 1200),
        (750, 1333),
        (810, 1440),
        (864, 1536),
        (960, 1707),
        (1080, 1920),
        (1200, 1707),
        (1308, 1536),
        (1440, 1350),
        (1536, 1152),
        (1707, 960),
        (1920, 1080),
    ],
}


def find_nearest_bucket(h, w, resolution=640):
    min_metric = float('inf')
    best_bucket = None
    for (bucket_h, bucket_w) in bucket_options[resolution]:
        metric = abs(h * bucket_w - w * bucket_h)
        if metric <= min_metric:
            min_metric = metric
            best_bucket = (bucket_h, bucket_w)
    return best_bucket

